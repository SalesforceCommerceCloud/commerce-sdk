
import { StaticClient, BaseClient, BaseClientConfig, ResponseError, AuthSchemes } from "@commerce-apps/core";
import _ from "lodash";

import {
{{#each dataTypes}}
    {{#if (isTypeDefinition .)}}
        {{getValue name}},
    {{/if}}
{{/each}}
} from "./{{apiSpec}}.types";

export {
{{#each dataTypes}}
    {{#if (isTypeDefinition .)}}
        {{getValue name}},
    {{/if}}
{{/each}}
} from "./{{apiSpec}}.types";

type ClientConfig = BaseClientConfig & {
  baseUriParameters?: {
    {{#each (getBaseUriParameters models.[0]) }}
    "{{{this}}}": string;
    {{/each}}
  }
}

/**
* Instantiate a Client object with desired ClientConfig to perform operations 
* available in this API client.
* 
* Note: When performing operations that require ShopperJWT authentication, an
* Authorization header containing a JWT can be added to the headers field of the 
* ClientConfig object. The Client will use that Authorization header for all the 
* operations it is used to perform.
*/
export class Client extends BaseClient {
  constructor(config: ClientConfig) {
    super(config);

    if (!!!config.baseUri) {
      this.clientConfig.baseUri = "{{getBaseUri models.[0] }}";
    }
    {{#each models}}
        {{#each declares}}
            {{#is ./$classData/name "amf.client.model.domain.SecurityScheme"}}
                this.authSchemes["{{./name}}"] = new AuthSchemes["{{./name}}"]();
            {{/is}}
        {{/each}}
    {{/each}}
  }

{{#each models}}
    {{> operations model=. }}
{{/each}}

}

export default Client;
export { ClientConfig };
