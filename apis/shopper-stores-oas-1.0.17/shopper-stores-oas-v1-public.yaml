openapi: 3.0.3
info:
  title: Shopper Stores
  version: v1
  description: |-
    # API Overview

    Provides access to stores via search or ID lookup.


    ## Authentication & Authorization

    The Shopper Stores API requires a shopper access token from the [Shopper Login and API Access Service (SLAS).](https://developer.salesforce.com/docs/commerce/commerce-api/guide/authorization-for-shopper-apis.html)

    You must include the relevant scope(s) in the client ID used to generate the SLAS token. For details, see [Authorization Scopes Catalog.](https://developer.salesforce.com/docs/commerce/commerce-api/guide/auth-z-scope-catalog.html)
servers:
  - url: https://{shortCode}.api.commercecloud.salesforce.com/store/shopper-stores/v1
    variables:
      shortCode:
        default: shortCode
paths:
  /organizations/{organizationId}/stores:
    get:
      summary: Return stores identified by the IDs provided as input.
      operationId: getStores
      parameters:
        - $ref: '#/components/parameters/organizationId'
        - $ref: '#/components/parameters/ids'
        - $ref: '#/components/parameters/siteId'
        - $ref: '#/components/parameters/locale'
      responses:
        '200':
          description: Returned details for specific stores.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StoreResult'
              examples:
                StoresResult:
                  $ref: '#/components/examples/StoresResult'
        '400':
          description: A value constraint for query parameters was violated. Or, a combination of latitude and longitude, a combination of country code and postal code, or an invalid distance_unit was provided.
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                MissingIds400:
                  $ref: '#/components/examples/MissingIds400'
      security:
        - ShopperToken:
            - sfcc.shopper-stores
  /organizations/{organizationId}/store-search:
    get:
      summary: Retrieve a list of stores for the given site that are within a configured distance of a geolocation.
      description: |
        - The distance is interpreted either in miles or kilometers, depending on the `distanceUnit` input parameter.
        - The location is specified by either directly providing a latitude and longitude coordinate pair, or by providing a country and a postal code. If a postal code is passed, the resource looks in the system's geolocation mappings in Business Manager to find the coordinates for this postal code. If no matching geolocation is found, the resource returns an empty list of stores. If coordinates are passed, the values for country and postal code are ignored.

          To verify site latitude and longitude information in Business Manager:
          - Navigate to **Merchant Tools -> Online Marketing -> Stores**.
          - Select the applicable site.
          - In the **Address** tab, verify that valid information is provided in the following fields: **Address**, **City**, **Postal Code**, **State**, and **Country**. For latitude and longitude values, you can manually enter values or provide all field values to auto-populate **Latitude** and **Longitude**. You must provide valid values for all of the previous fields for latitude and longitude to auto-populate **Latitude** and **Longitude** values.
      operationId: searchStores
      parameters:
        - $ref: '#/components/parameters/organizationId'
        - $ref: '#/components/parameters/countryCode'
        - $ref: '#/components/parameters/distanceUnit'
        - $ref: '#/components/parameters/latitude'
        - $ref: '#/components/parameters/longitude'
        - $ref: '#/components/parameters/maxDistance'
        - $ref: '#/components/parameters/postalCode'
        - $ref: '#/components/parameters/siteId'
        - $ref: '#/components/parameters/locale'
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            format: int32
            default: 25
            maximum: 200
          description: Maximum records to retrieve per request, not to exceed 200. Defaults to 25.
        - name: offset
          in: query
          required: false
          schema:
            type: integer
            format: int64
            default: 0
            minimum: 0
          description: Used to retrieve the results based on a particular resource offset.
      responses:
        '200':
          description: Returned a list of stores for the given search parameters, up to the paging size, including their distance from the given geolocation and additional information on the pagination of objects.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Stores'
              examples:
                StoreSearchResult:
                  $ref: '#/components/examples/StoreSearchResult'
        '400':
          description: A value constraint for query parameters was violated. Or, a combination of latitude and longitude, a combination of country code and postal code, or an invalid distance_unit was provided.
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                MissingPostalCode400:
                  $ref: '#/components/examples/MissingPostalCode400'
      security:
        - ShopperToken:
            - sfcc.shopper-stores
components:
  securitySchemes:
    ShopperToken:
      type: oauth2
      description: "ShopperToken authentication follows the authorization code grant flow, as defined by the OAuth 2.1 standard. Depending on the type of OAuth client (public or private), this authorization flow has further requirements. \nFor a detailed description of the authorization flow, see the [SLAS overview](https://developer.salesforce.com/docs/commerce/commerce-api/references?meta=shopper-login:Summary).\nA shopper token allows you to access the Shopper API endpoints of both OCAPI and the B2C Commerce API. These endpoints can be used to build headless storefronts and other applications.\nThe `ShopperToken` security scheme is a parent of other security schemes, such as `ShopperTokenTsob`. A Shopper API endpoint can require a specific child scheme (`ShopperTokenTsob`, for example) that cannot be accessed with a regular shopper token.\n"
      flows:
        clientCredentials:
          tokenUrl: https://{shortCode}.api.commercecloud.salesforce.com/shopper/auth/v1/organizations/{organizationId}/oauth2/token
          scopes:
            sfcc:shopper-stores: Allows read operations on shopper-stores
        authorizationCode:
          authorizationUrl: https://{short-code}.api.commercecloud.salesforce.com/shopper/auth/v1/organizations/{organizationId}/oauth2/authorize
          tokenUrl: https://{short-code}.api.commercecloud.salesforce.com/shopper/auth/v1/organizations/{organizationId}/oauth2/token
          scopes:
            sfcc.shopper-stores: Allows read operations on shopper-stores
  schemas:
    OrganizationId:
      description: An identifier for the organization the request is being made by
      example: f_ecom_zzxy_prd
      type: string
      minLength: 1
      maxLength: 32
    SiteId:
      minLength: 1
      maxLength: 32
      description: The identifier of the site that a request is being made in the context of. Attributes might have site specific values, and some objects may only be assigned to specific sites
      example: RefArch
      type: string
    LanguageCountry:
      pattern: ^[a-z][a-z]-[A-Z][A-Z]$
      description: A concatenated version of the standard Language and Country codes, combined with a hyphen '`-`'.
      example: en-US
      type: string
    LanguageCode:
      pattern: ^[a-z][a-z]$
      description: A two letter lowercase language code conforming to the [ISO 639-1](https://www.iso.org/iso-639-language-codes.html) standard. Additionally, this may be used to submit requests with the header parameter `Accept-Language`, following [RFC 2616](https://tools.ietf.org/html/rfc2616) & [RFC 1766](https://tools.ietf.org/html/rfc1766).
      example: en
      type: string
    DefaultFallback:
      default: default
      description: A specialized value indicating the system default values for locales.
      example: default
      enum:
        - default
      type: string
    LocaleCode:
      description: A descriptor for a geographical region by both a language and country code. By combining these two, regional differences in a language can be addressed, such as with the request header parameter `Accept-Language` following [RFC 2616](https://tools.ietf.org/html/rfc2616) & [RFC 1766](https://tools.ietf.org/html/rfc1766). This can also just refer to a language code, also RFC 2616/1766 compliant, as a default if there is no specific match for a country. Finally, can also be used to define default behavior if there is no locale specified.
      oneOf:
        - $ref: '#/components/schemas/LanguageCountry'
        - $ref: '#/components/schemas/LanguageCode'
        - $ref: '#/components/schemas/DefaultFallback'
    Limit:
      default: 10
      minimum: 1
      format: int32
      description: Maximum records to retrieve per request, not to exceed the maximum defined. A limit must be at least 1 so at least one record is returned (if any match the criteria).
      type: integer
      example: 10
    Total:
      default: 0
      minimum: 0
      format: int64
      description: The total number of hits that match the search's criteria. This can be greater than the number of results returned as search results are pagenated.
      type: integer
      example: 10
    ResultBase:
      description: "Schema defining generic list result. Each response schema of a resource requiring a list response should extend this schema. \nAdditionally it needs to be defined what data is returned."
      type: object
      required:
        - limit
        - total
      properties:
        limit:
          maximum: 200
          allOf:
            - $ref: '#/components/schemas/Limit'
        total:
          $ref: '#/components/schemas/Total'
    CountryCode:
      pattern: ^[A-Z][A-Z]$
      description: A two letter uppercase country code conforming to the [ISO 3166-1](https://www.iso.org/iso-3166-country-codes.html) alpha-2 standard.
      example: US
      type: string
    Distance:
      minimum: 0
      maximum: 20012
      format: double
      description: The distance to the given geolocation where the stores will be searched, using the unit given in the attribute 'DistanceUnit' (miles or kilometers).
      type: number
    DistanceUnit:
      description: The unit the distance attribute is measured in (either in miles or kilometers).
      enum:
        - km
        - mi
      type: string
    Latitude:
      minimum: -90
      maximum: 90
      format: double
      description: The latitude of the store.
      type: number
    Longitude:
      minimum: -180
      maximum: 180
      format: double
      description: The longitude of the store.
      type: number
    PostalCode:
      minLength: 3
      maxLength: 10
      description: The postal code of the store.
      type: string
    Store:
      description: Document representing a store.
      properties:
        address1:
          minLength: 1
          description: The primary address of the store.
          type: string
        address2:
          description: The secondary address of the store.
          type: string
        city:
          description: The city of the store.
          type: string
        countryCode:
          $ref: '#/components/schemas/CountryCode'
        distance:
          $ref: '#/components/schemas/Distance'
        distanceUnit:
          $ref: '#/components/schemas/DistanceUnit'
        email:
          description: The email address of the store.
          type: string
        fax:
          description: The fax number of the store.
          type: string
        id:
          minLength: 1
          maxLength: 256
          description: The id of the store.
          type: string
        image:
          description: The store image.
          type: string
        inventoryId:
          maxLength: 256
          description: The inventory list id associated with this store.
          type: string
        latitude:
          $ref: '#/components/schemas/Latitude'
        longitude:
          $ref: '#/components/schemas/Longitude'
        name:
          description: The store name.
          type: string
        phone:
          description: The phone number of the store.
          type: string
        posEnabled:
          description: Whether this store uses Store Point-of-Sale.
          type: boolean
        postalCode:
          description: The postal code of the store.
          allOf:
            - $ref: '#/components/schemas/PostalCode'
        stateCode:
          description: The state code of the store.
          type: string
        storeEvents:
          description: The store events.
          type: string
        storeHours:
          description: The opening hours of the store.
          type: string
        storeLocatorEnabled:
          description: Whether this store should show up in store locator results.
          type: boolean
      required:
        - id
      type: object
    StoreResult:
      description: Result object containing an array of stores.
      type: object
      allOf:
        - $ref: '#/components/schemas/ResultBase'
      properties:
        data:
          description: The list of stores in the search result.
          type: array
          items:
            $ref: '#/components/schemas/Store'
    ErrorResponse:
      type: object
      additionalProperties: true
      properties:
        title:
          description: "A short, human-readable summary of the problem\ntype.  It will not change from occurrence to occurrence of the \nproblem, except for purposes of localization\n"
          type: string
          maxLength: 256
          example: You do not have enough credit
        type:
          description: |
            A URI reference [RFC3986] that identifies the
            problem type.  This specification encourages that, when
            dereferenced, it provide human-readable documentation for the
            problem type (e.g., using HTML [W3C.REC-html5-20141028]).  When
            this member is not present, its value is assumed to be
            "about:blank". It accepts relative URIs; this means
            that they must be resolved relative to the document's base URI, as
            per [RFC3986], Section 5.
          type: string
          maxLength: 2048
          example: NotEnoughMoney
        detail:
          description: A human-readable explanation specific to this occurrence of the problem.
          type: string
          example: Your current balance is 30, but that costs 50
        instance:
          description: |
            A URI reference that identifies the specific
            occurrence of the problem.  It may or may not yield further
            information if dereferenced.  It accepts relative URIs; this means
            that they must be resolved relative to the document's base URI, as
            per [RFC3986], Section 5.
          type: string
          maxLength: 2048
          example: /account/12345/msgs/abc
      required:
        - title
        - type
        - detail
    Offset:
      default: 0
      minimum: 0
      format: int64
      description: The zero-based index of the first hit/data to include in the result.
      type: integer
      example: 0
    PaginatedResultBase:
      description: "Schema defining generic pageable result. Each response schema of a resource requiring pagination should extend this schema. \nIf you use this extend this schema directly, it needs to be defined what data is returned. Allowed names for the data field is `data`."
      type: object
      allOf:
        - $ref: '#/components/schemas/ResultBase'
      properties:
        offset:
          $ref: '#/components/schemas/Offset'
      required:
        - limit
        - offset
        - total
    Stores:
      description: Result object containing an paginated array of stores.
      type: object
      allOf:
        - $ref: '#/components/schemas/PaginatedResultBase'
      properties:
        data:
          description: The list of stores in the search result.
          type: array
          items:
            $ref: '#/components/schemas/Store'
  parameters:
    organizationId:
      description: An identifier for the organization the request is being made by
      name: organizationId
      in: path
      required: true
      example: f_ecom_zzxy_prd
      schema:
        $ref: '#/components/schemas/OrganizationId'
    ids:
      name: ids
      in: query
      description: The IDs of a requested stores (comma separated, max 50 IDs).
      required: true
      schema:
        maxLength: 256
        minLength: 1
        type: string
    siteId:
      description: The identifier of the site that a request is being made in the context of. Attributes might have site specific values, and some objects may only be assigned to specific sites.
      name: siteId
      in: query
      required: true
      examples:
        SiteId:
          value: RefArch
      schema:
        $ref: '#/components/schemas/SiteId'
    locale:
      description: A descriptor for a geographical region by both a language and country code. By combining these two, regional differences in a language can be addressed, such as with the request header parameter `Accept-Language` following [RFC 2616](https://tools.ietf.org/html/rfc2616) & [RFC 1766](https://tools.ietf.org/html/rfc1766). This can also just refer to a language code, also RFC 2616/1766 compliant, as a default if there is no specific match for a country. Finally, can also be used to define default behavior if there is no locale specified.
      name: locale
      in: query
      examples:
        LanguageCountry:
          value: en-US
        CountryCode:
          value: US
      schema:
        $ref: '#/components/schemas/LocaleCode'
    countryCode:
      name: countryCode
      in: query
      schema:
        $ref: '#/components/schemas/CountryCode'
      description: The two letter ISO country code, such as "US". This value is required when a postalCode is provided.
      required: false
    distanceUnit:
      name: distanceUnit
      in: query
      description: The distance unit. Supported values are "mi" (miles) and "km" (kilometers). The default is "km".
      required: false
      schema:
        $ref: '#/components/schemas/DistanceUnit'
    latitude:
      name: latitude
      in: query
      description: The geographical latitude to search for stores (value range -90.00 .. 90.00). This value is required when a longitude is provided.
      required: false
      schema:
        $ref: '#/components/schemas/Latitude'
    longitude:
      name: longitude
      in: query
      description: The geographical longitude to search for stores (value range -180.00 .. 180.00). You must provide a longitude when a latitude is provided.
      required: false
      schema:
        $ref: '#/components/schemas/Longitude'
    maxDistance:
      name: maxDistance
      in: query
      description: The area (radius) in distanceUnit where stores will be searched.
      required: false
      schema:
        $ref: '#/components/schemas/Distance'
    postalCode:
      name: postalCode
      in: query
      description: The postal code, such as "84121". You must provide a countryCode when a postalCode is provided.
      required: false
      schema:
        $ref: '#/components/schemas/PostalCode'
  examples:
    StoresResult:
      value:
        data:
          - address1: 1487 Bay St
            city: Springfield
            countryCode: US
            distance: 147.03
            distanceUnit: km
            id: store9
            name: Springfield Media Store
            phone: +1-413-413-6916
            posEnabled: false
            postalCode: '01109'
            stateCode: MA
            storeEvents: Here are some store events.
            storeHours: Here are the store hours
            storeLocatorEnabled: true
          - address1: 70 Wood Ave
            city: Bridgeport
            countryCode: US
            distance: 198.36
            distanceUnit: km
            email: store1@company.com
            id: store11
            name: Electronics Super Store
            phone: +1-203-965-7014
            posEnabled: false
            postalCode: '06605'
            stateCode: CT
            storeLocatorEnabled: true
          - address1: 239 Bridge St
            city: Manchester
            countryCode: US
            distance: 219
            distanceUnit: km
            id: store8
            name: Gardena Mart
            phone: +1-603-715-9773
            posEnabled: false
            postalCode: '03104'
            stateCode: NH
            storeLocatorEnabled: true
          - address1: 150 Winthrop Ave
            city: Lawrence
            countryCode: US
            distance: 242.77
            distanceUnit: km
            id: store6
            name: Khale Street Electronics
            phone: +1-978-580-2704
            posEnabled: false
            postalCode: '01843'
            stateCode: MA
            storeLocatorEnabled: true
          - address1: 110 Smith St
            city: Providence
            countryCode: US
            distance: 245.02
            distanceUnit: km
            email: store2@company.com
            id: store2
            name: Super Electronics
            phone: +1-401-312-6284
            posEnabled: false
            postalCode: '02903'
            stateCode: RI
            storeLocatorEnabled: true
        limit: 5
        total: 12
    MissingIds400:
      value:
        detail: 'Missing required query parameter(s): ''ids'''
        title: Bad Request
        type: https://api.commercecloud.salesforce.com/documentation/error/v1/errors/missing-query-parameter
    StoreSearchResult:
      value:
        data:
          - address1: 1487 Bay St
            city: Springfield
            countryCode: US
            distance: 147.03
            distanceUnit: km
            id: store9
            name: Springfield Media Store
            phone: +1-413-413-6916
            posEnabled: false
            postalCode: '01109'
            stateCode: MA
            storeEvents: Here are some store events.
            storeHours: Here are the store hours
            storeLocatorEnabled: true
          - address1: 70 Wood Ave
            city: Bridgeport
            countryCode: US
            distance: 198.36
            distanceUnit: km
            email: store1@company.com
            id: store11
            name: Electronics Super Store
            phone: +1-203-965-7014
            posEnabled: false
            postalCode: '06605'
            stateCode: CT
            storeLocatorEnabled: true
          - address1: 239 Bridge St
            city: Manchester
            countryCode: US
            distance: 219
            distanceUnit: km
            id: store8
            name: Gardena Mart
            phone: +1-603-715-9773
            posEnabled: false
            postalCode: '03104'
            stateCode: NH
            storeLocatorEnabled: true
          - address1: 150 Winthrop Ave
            city: Lawrence
            countryCode: US
            distance: 242.77
            distanceUnit: km
            id: store6
            name: Khale Street Electronics
            phone: +1-978-580-2704
            posEnabled: false
            postalCode: '01843'
            stateCode: MA
            storeLocatorEnabled: true
          - address1: 110 Smith St
            city: Providence
            countryCode: US
            distance: 245.02
            distanceUnit: km
            email: store2@company.com
            id: store2
            name: Super Electronics
            phone: +1-401-312-6284
            posEnabled: false
            postalCode: '02903'
            stateCode: RI
            storeLocatorEnabled: true
        limit: 5
        offset: 0
        total: 12
    MissingPostalCode400:
      value:
        title: Missing Postal Code
        type: https://api.commercecloud.salesforce.com/documentation/error/v1/errors/missing-postal-code
        detail: The input parameter 'postal_code' is required when no coordinates are provided.
