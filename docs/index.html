<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>commerce-sdk</title>
	<meta name="description" content="Documentation for commerce-sdk">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">commerce-sdk</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
							<input type="checkbox" id="tsd-filter-only-exported" />
							<label class="tsd-widget" for="tsd-filter-only-exported">Only exported</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="globals.html">Globals</a>
				</li>
			</ul>
			<h1>commerce-sdk</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#commerce-sdk" id="commerce-sdk" style="color: inherit; text-decoration: none;">
					<h1>commerce-sdk</h1>
				</a>
				<p>The Salesforce Commerce SDK allows easy interaction with the Salesforce B2C Commerce platform APIs on the Node.js runtime.</p>
				<p>Visit the <a href="https://developer.commercecloud.com/">Commerce Cloud Developer Center</a> to learn more about Salesforce Commerce. The developer center has API documentation, getting started guides, community forums, and more.
				​</p>
				<a href="#prerequisites" id="prerequisites" style="color: inherit; text-decoration: none;">
					<h2>Prerequisites</h2>
				</a>
				<p>Download and install Node.js and npm <a href="https://nodejs.org/en/download/">here</a>.
				​</p>
				<blockquote>
					<p><strong>Note:</strong> Only Node.js version 10 and 12 LTS are supported. Other versions can cause unexpected results. To use a different version of Node.js for other projects, you can manage multiple versions of Node.js with <a href="https://github.com/nvm-sh/nvm">nvm</a>.
					​</p>
				</blockquote>
				<a href="#installation" id="installation" style="color: inherit; text-decoration: none;">
					<h2>Installation</h2>
				</a>
				<p>Use npm to install the Commerce SDK.
				​</p>
				<pre><code>npm <span class="hljs-keyword">install</span> commerce-sdk</code></pre>
				<a href="#usage" id="usage" style="color: inherit; text-decoration: none;">
					<h2>Usage</h2>
				</a>
				<p>To use an SDK client, instantiate an object of that client and configure these parameters.</p>
				<blockquote>
					<p><strong>Note:</strong> These are optional parameters.</p>
				</blockquote>
				<table>
					<thead>
						<tr>
							<th>Parameter</th>
							<th align="left">Description</th>
						</tr>
					</thead>
					<tbody><tr>
							<td>baseUri</td>
							<td align="left">URL of the service with which the SDK interacts. If the baseUri isn&#39;t provided, the default baseUri for the relevant RAML file is used.</td>
						</tr>
						<tr>
							<td>clientId</td>
							<td align="left">ID of the client account created with Salesforce Commerce.</td>
						</tr>
						<tr>
							<td>organizationId</td>
							<td align="left">The unique identifier for your Salesforce identity.</td>
						</tr>
						<tr>
							<td>shortCode</td>
							<td align="left">Region specific merchant ID.</td>
						</tr>
						<tr>
							<td>siteId</td>
							<td align="left">A unique site ID (for example, RefArch or SiteGenesis).</td>
						</tr>
				</tbody></table>
				<a href="#sample-code" id="sample-code" style="color: inherit; text-decoration: none;">
					<h3>Sample Code</h3>
				</a>
				<pre><code class="language-javascript"><span class="hljs-comment">/**
 * Sample TypeScript code that shows how Commerce SDK can access Salesforce Commerce
 * APIs.
 */</span>
​
<span class="hljs-comment">// Import the SDK in TypeScript</span>
<span class="hljs-comment">// tsc requires the --esModuleInterop flag for this</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> CommerceSdk <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;commerce-sdk&quot;</span>;
<span class="hljs-comment">// For Javascript, use:</span>
<span class="hljs-comment">// import CommerceSdk from &quot;commerce-sdk&quot;;</span>
<span class="hljs-keyword">const</span> { ClientConfig, helpers, Search } = CommerceSdk;
<span class="hljs-comment">// Older Node.js versions can instead use:</span>
<span class="hljs-comment">// const { ClientConfig, helpers, Search } = require(&quot;commerce-sdk&quot;);</span>

<span class="hljs-comment">// Create a configuration to use when creating API clients</span>
<span class="hljs-keyword">const</span> config = {
    <span class="hljs-attr">headers</span>: {},
    <span class="hljs-attr">parameters</span>: {
        <span class="hljs-attr">clientId</span>: <span class="hljs-string">&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;</span>,
        <span class="hljs-attr">organizationId</span>: <span class="hljs-string">&quot;f_ecom_bblx_stg&quot;</span>,
        <span class="hljs-attr">shortCode</span>: <span class="hljs-string">&quot;0dnz6oep&quot;</span>,
        <span class="hljs-attr">siteId</span>: <span class="hljs-string">&quot;RefArch&quot;</span>
    }
}

<span class="hljs-comment">// Get a JWT to use with Shopper API clients, a guest token in this case</span>
helpers.getShopperToken(config, { <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;guest&quot;</span> }).then(<span class="hljs-keyword">async</span> (token) =&gt; {

    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// Add the token to the client configuration</span>
        config.headers[<span class="hljs-string">&quot;authorization&quot;</span>] = token.getBearerHeader();

        <span class="hljs-comment">// Create a new ShopperSearch API client</span>
        <span class="hljs-keyword">const</span> searchClient = <span class="hljs-keyword">new</span> Search.ShopperSearch(config);

        <span class="hljs-comment">// Search for dresses</span>
        <span class="hljs-keyword">const</span> searchResults = <span class="hljs-keyword">await</span> searchClient.productSearch({
            <span class="hljs-attr">parameters</span>: {
                <span class="hljs-attr">q</span>: <span class="hljs-string">&quot;dress&quot;</span>,
                <span class="hljs-attr">limit</span>: <span class="hljs-number">5</span>
            }
        });

        <span class="hljs-keyword">if</span> (searchResults.total) {
            <span class="hljs-keyword">const</span> firstResult = searchResults.hits[<span class="hljs-number">0</span>];
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${firstResult.productId}</span> <span class="hljs-subst">${firstResult.productName}</span>`</span>);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;No results for search&quot;</span>);
        }

        <span class="hljs-keyword">return</span> searchResults;

    } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-built_in">console</span>.error(e);
        <span class="hljs-built_in">console</span>.error(<span class="hljs-keyword">await</span> e.response.text());
    }
}).catch(<span class="hljs-keyword">async</span> (e) =&gt; {
    <span class="hljs-built_in">console</span>.error(e);
    <span class="hljs-built_in">console</span>.error(<span class="hljs-keyword">await</span> e.response.text());
});</code></pre>
				<p>When using an IDE such as VSCode, the autocomplete feature lets you view the available method and class definitions, including parameters.
				​</p>
				<p><img src="https://github.com/SalesforceCommerceCloud/commerce-sdk/raw/master/packages/generator/images/Autocomplete.jpg?raw=true" alt="Autocomplete" title="Autocomplete"></p>
				<p>To view the details of a method or a variable, hover over methods and variables.
				​</p>
				<p><img src="https://github.com/SalesforceCommerceCloud/commerce-sdk/raw/master/packages/generator/images/MethodDetails.jpg?raw=true" alt="Method Details" title="Method Details"></p>
				<p><img src="https://github.com/SalesforceCommerceCloud/commerce-sdk/raw/master/packages/generator/images/ParameterDetails.jpg?raw=true" alt="Parameter Details" title="Parameter Details"></p>
				<p>Autocomplete will also show the available properties of the data returned by SDK methods.</p>
				<p><img src="https://github.com/SalesforceCommerceCloud/commerce-sdk/raw/master/packages/generator/images/ResultAutocomplete.jpg?raw=true" alt="Result Autocomplete" title="Result Autocomplete"></p>
				<a href="#caching" id="caching" style="color: inherit; text-decoration: none;">
					<h2>Caching</h2>
				</a>
				<p>The SDK currently supports two types of caches - In-memory and Redis. Both the implementations respect <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control">standard cache headers</a>. If you would like to use another type of cache, you can write your own implementation of the <a href="../core/src/base/cacheManager.ts">CacheManager</a>. You can refer to this <a href="../core/src/base/cacheManagerKeyv.ts">default cache manager</a> when designing your implementation.  </p>
				<a href="#cache-storage-adapter" id="cache-storage-adapter" style="color: inherit; text-decoration: none;">
					<h3>Cache storage adapter</h3>
				</a>
				<p>The default cache storage limits to 10,000 distinct entities before applying a simple <a href="https://en.m.wikipedia.org/wiki/Cache_replacement_policies#Least_Recently_Used_.28LRU.29">least recently used</a> policy for cache replacement. You can change the limit by creating a <a href="https://www.npmjs.com/package/quick-lru">quick-lru</a> storage adapter.</p>
				<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { CacheManagerKeyv } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@commerce-apps/core&quot;</span>;
<span class="hljs-keyword">import</span> { QuickLRU } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;quick-lru&quot;</span>;

<span class="hljs-keyword">const</span> cacheManagerKeyv = <span class="hljs-keyword">new</span> CacheManagerKeyv({ <span class="hljs-attr">keyvStore</span>: <span class="hljs-keyword">new</span> QuickLRU({ <span class="hljs-attr">maxSize</span>: <span class="hljs-number">50000</span> })});
<span class="hljs-keyword">const</span> config = {
     <span class="hljs-attr">cacheManager</span>: cacheManagerKeyv,
     <span class="hljs-attr">parameters</span>: {
         <span class="hljs-attr">clientId</span>: <span class="hljs-string">&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;</span>,
         <span class="hljs-attr">organizationId</span>: <span class="hljs-string">&quot;f_ecom_bblx_stg&quot;</span>,
         <span class="hljs-attr">shortCode</span>: <span class="hljs-string">&quot;0dnz6oep&quot;</span>,
         <span class="hljs-attr">siteId</span>: <span class="hljs-string">&quot;RefArch&quot;</span>
     }
 }</code></pre>
				<p>Refer to these <a href="https://www.npmjs.com/package/keyv#third-party-storage-adapters">directions</a> to create your own cache storage adapter.</p>
				<a href="#in-memory-cache" id="in-memory-cache" style="color: inherit; text-decoration: none;">
					<h3>In-memory cache</h3>
				</a>
				<p>In-memory caching of responses is enabled by default. To disable caching for a client, set cacheManager to &#39;null&#39;.</p>
				<pre><code class="language-javascript"><span class="hljs-keyword">const</span> config = {
    <span class="hljs-attr">cacheManager</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">parameters</span>: {
        <span class="hljs-attr">clientId</span>: <span class="hljs-string">&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;</span>,
        <span class="hljs-attr">organizationId</span>: <span class="hljs-string">&quot;f_ecom_bblx_stg&quot;</span>,
        <span class="hljs-attr">shortCode</span>: <span class="hljs-string">&quot;0dnz6oep&quot;</span>,
        <span class="hljs-attr">siteId</span>: <span class="hljs-string">&quot;RefArch&quot;</span>
    }
}</code></pre>
				<a href="#redis-cache" id="redis-cache" style="color: inherit; text-decoration: none;">
					<h3>Redis cache</h3>
				</a>
				<p>To use a Redis cache, instantiate a CacheManagerRedis object with your Redis URL and put it in your client config object.</p>
				<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { CacheManagerRedis } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@commerce-apps/core&quot;</span>

<span class="hljs-keyword">const</span> cacheManager = <span class="hljs-keyword">new</span> CacheManagerRedis({ <span class="hljs-attr">connection</span>: <span class="hljs-string">&quot;redis://localhost:6379&quot;</span> });
<span class="hljs-keyword">const</span> config = {
    <span class="hljs-attr">cacheManager</span>: cacheManager,
    <span class="hljs-attr">parameters</span>: {
        <span class="hljs-attr">clientId</span>: <span class="hljs-string">&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;</span>,
        <span class="hljs-attr">organizationId</span>: <span class="hljs-string">&quot;f_ecom_bblx_stg&quot;</span>,
        <span class="hljs-attr">shortCode</span>: <span class="hljs-string">&quot;0dnz6oep&quot;</span>,
        <span class="hljs-attr">siteId</span>: <span class="hljs-string">&quot;RefArch&quot;</span>
    }
}</code></pre>
				<a href="#memory-management" id="memory-management" style="color: inherit; text-decoration: none;">
					<h4>Memory management</h4>
				</a>
				<p>When the specified amount of memory is reached, Redis can be configured to apply an eviction policy. Refer to <a href="https://redis.io/topics/lru-cache/">this article</a> to setup Redis as an LRU cache and to learn more about supported eviction policies. </p>
				<a href="#retry-policies" id="retry-policies" style="color: inherit; text-decoration: none;">
					<h2>Retry Policies</h2>
				</a>
				<p>We are utilizing the node-retry package to facilitate request retries.  The retry type definition looks as follows as taken from the node-retry package.</p>
				<pre><code class="language-typescript"><span class="hljs-keyword">type</span> RetrySettings = {
    <span class="hljs-comment">/**
     * Whether to retry forever.
     * @default false
     */</span>
    forever?: <span class="hljs-built_in">boolean</span>;
    <span class="hljs-comment">/**
     * Whether to [unref](https://nodejs.org/api/timers.html#timers_unref) the setTimeout&#x27;s.
     * @default false
     */</span>
    unref?: <span class="hljs-built_in">boolean</span>;
    <span class="hljs-comment">/**
     * The maximum time (in milliseconds) that the retried operation is allowed to run.
     * @default Infinity
     */</span>
    maxRetryTime?: <span class="hljs-built_in">number</span>;
    <span class="hljs-comment">/**
     * The maximum amount of times to retry the operation.
     * @default 10
     */</span>
    retries?: <span class="hljs-built_in">number</span>;
        <span class="hljs-comment">/**
     * The exponential factor to use.
     * @default 2
     */</span>
    factor?: <span class="hljs-built_in">number</span>;
    <span class="hljs-comment">/**
     * The number of milliseconds before starting the first retry.
     * @default 1000
     */</span>
    minTimeout?: <span class="hljs-built_in">number</span>;
    <span class="hljs-comment">/**
     * The maximum number of milliseconds between two retries.
     * @default Infinity
     */</span>
    maxTimeout?: <span class="hljs-built_in">number</span>;
    <span class="hljs-comment">/**
     * Randomizes the timeouts by multiplying a factor between 1-2.
     * @default false
     */</span>
    randomize?: <span class="hljs-built_in">boolean</span>;
}</code></pre>
				<p>All of these options can either be set on a per client or per request basis.</p>
				<p>Example:</p>
				<pre><code class="language-javascript">
    productClient = <span class="hljs-keyword">new</span> Product({
      <span class="hljs-attr">retrySettings</span>: {

        <span class="hljs-comment">// This means 3 total calls are made</span>
        <span class="hljs-attr">retries</span>: <span class="hljs-number">2</span>,

        <span class="hljs-comment">// Max wait between retries</span>
        <span class="hljs-attr">maxTimeout</span>: <span class="hljs-number">200</span>,

        <span class="hljs-comment">// Min wait between retries</span>
        <span class="hljs-attr">minTimeout</span>: <span class="hljs-number">100</span>
      }
    }
</code></pre>
				<a href="#logging" id="logging" style="color: inherit; text-decoration: none;">
					<h2>Logging</h2>
				</a>
				<p>Default log level of the SDK is WARN (warning). SDK uses <a href="https://www.npmjs.com/package/loglevel">loglevel</a> npm package. All the log levels supported by <a href="https://www.npmjs.com/package/loglevel">loglevel</a> package are supported in SDK.</p>
				<p>To change the loglevel, set the desired level on the SDK logger.</p>
				<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { sdkLogger } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;commerce-sdk&quot;</span>;

sdkLogger.setLevel(sdkLogger.levels.INFO);</code></pre>
				<p>INFO level logging will enable brief request and response logging.
				DEBUG level logging will enable logging of </p>
				<ul>
					<li>fetch options</li>
					<li>curl command of the request</li>
					<li>response (response body is not included)</li>
					<li>cache operations</li>
				</ul>
				<p><strong>Note:</strong> Debug level logging may expose sensitive data in the logs </p>
				<a href="#additional-documentation" id="additional-documentation" style="color: inherit; text-decoration: none;">
					<h2>Additional Documentation</h2>
				</a>
				<p><a href="./APICLIENTS.md">API Documentation</a><br><a href="./CHANGELOG.md">Changelog</a></p>
				<a href="#license-information" id="license-information" style="color: inherit; text-decoration: none;">
					<h2>License Information</h2>
				</a>
				<p>The Commerce SDK is licensed under BSD-3-Clause license. See the <a href="./LICENSE.txt">license</a> for details.</p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="globals  ">
						<a href="globals.html"><em>Globals</em></a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_helpers_.html">&quot;helpers&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_index_.html">&quot;index&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/cdn.html">cdn</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/checkout.html">checkout</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/customer.html">customer</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/pricing.html">pricing</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/product.html">product</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/search.html">search</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/seller.html">seller</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/unclassified.html">unclassified</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
				<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
				<li class="tsd-kind-type-alias tsd-has-type-parameter"><span class="tsd-kind-icon">Type alias with type parameter</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
<script>if (location.protocol == 'file:') document.write('<script src="assets/js/search.js"><' + '/script>');</script>
</body>
</html>